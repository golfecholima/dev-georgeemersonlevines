//code.stephenmorley.org
function SpinBox(e,t){"string"==typeof e&&(e=document.getElementById(e));this.options=t?t:{};"className"in this.options||(this.options.className="spinBox");"step"in this.options||(this.options.step=1);"decimals"in this.options||(this.options.decimals=0);var n=e.getElementsByTagName("input");0==n.length?(this.input=document.createElement("input"),this.setValue("value"in this.options?this.options.value:0),e.appendChild(this.input)):(this.input=n[0],"value"in this.options&&this.setValue(this.options.value));n=document.createElement("span");n.appendChild(document.createElement("span"));e.appendChild(n);var r=document.createElement("span");r.appendChild(document.createElement("span"));e.appendChild(r);e.className+=" "+this.options.className;n.className=this.options.className+"Up";r.className=this.options.className+"Down";this.addEventListener(this.input,"mousewheel",this.handleMouseWheel,[],!0);this.addEventListener(this.input,"DOMMouseScroll",this.handleMouseWheel,[],!0);this.addEventListener(this.input,"keydown",this.handleKeyDown,[],!0);this.addEventListener(this.input,"keypress",this.handleKeyPress,[],!0);this.addEventListener(this.input,"keyup",this.stop);this.addEventListener(n,"mousedown",this.start,[!0]);this.addEventListener(n,"mouseup",this.stop);this.addEventListener(n,"mouseout",this.stop);this.addEventListener(r,"mousedown",this.start,[!1]);this.addEventListener(r,"mouseup",this.stop);this.addEventListener(r,"mouseout",this.stop)}SpinBox.prototype.getValue=function(){return parseFloat(this.input.value)};SpinBox.prototype.setValue=function(e){"minimum"in this.options&&(e=Math.max(this.options.minimum,e));"maximum"in this.options&&(e=Math.min(this.options.maximum,e));var t=0>e?"-":"";e=Math.abs(e);var n=Math.pow(10,this.options.decimals);e=Math.round(e*n);var r=""+e%n;r.length<this.options.decimals&&(r="0"+r);this.input.value=t+(e-e%n)/n+(0<this.options.decimals?"."+r:"");if("dispatchEvent"in this.input){try{var i=new Event("change",{bubbles:!0,cancelable:!0})}catch(s){i=document.createEvent("Event"),i.initEvent("change",!0,!0)}this.input.dispatchEvent(i)}};SpinBox.prototype.addEventListener=function(e,t,n,r,i){function s(e){e||(e=window.event);n.apply(o,[e].concat(r));i||(e.preventDefault?e.preventDefault():e.returnValue=!1)}var o=this;e.addEventListener?e.addEventListener(t,s,!1):e.attachEvent("on"+t,s)};SpinBox.prototype.handleMouseWheel=function(e){document.activeElement==this.input&&(e.wheelDelta?this.start(e,1<e.wheelDelta):e.detail&&this.start(e,1>e.detail),this.stop(),e.preventDefault?e.preventDefault():e.returnValue=!1)};SpinBox.prototype.handleKeyDown=function(e){38==e.keyCode&&this.start(e,!0);40==e.keyCode&&this.start(e,!1)};SpinBox.prototype.handleKeyPress=function(e){var t="charCode"in e?e.charCode:e.keyCode;0==t||e.altKey||e.ctrlKey||e.metaKey||45==t&&(!("minimum"in this.options)||0>this.options.minimum)||46==t&&0<this.options.decimals||48<=t&&57>=t||(e.preventDefault?e.preventDefault():e.returnValue=!1)};SpinBox.prototype.start=function(e,t){this.input.disabled||"timeout"in this||(this.updateStep=t?this.options.step:-this.options.step,this.timeoutDelay=500,this.update())};SpinBox.prototype.stop=function(){"timeout"in this&&(window.clearTimeout(this.timeout),delete this.timeout)};SpinBox.prototype.update=function(){var e=parseFloat(this.input.value);isNaN(e)&&(e=0);this.setValue(e+this.updateStep);this.timeoutDelay=Math.max(20,Math.floor(.9*this.timeoutDelay));var t=this;this.timeout=window.setTimeout(function(){t.update()},this.timeoutDelay)};